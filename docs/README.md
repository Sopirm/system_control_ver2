# üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - –°–∏—Å—Ç–µ–º–∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ó–∞–¥–∞—á–∞–º–∏

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è REST API –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

```
docs/
‚îú‚îÄ‚îÄ README.md                    # –≠—Ç–æ—Ç —Ñ–∞–π–ª - –æ–±–∑–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ openapi.yaml                 # –û–±—â–∞—è OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ service_users_api.yaml       # API —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ service_orders_api.yaml      # API —Å–µ—Ä–≤–∏—Å–∞ –∑–∞–∫–∞–∑–æ–≤
‚îú‚îÄ‚îÄ postman_collection.json      # Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ api_examples.md              # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
‚îî‚îÄ‚îÄ authentication_guide.md      # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

**Online –ø—Ä–æ—Å–º–æ—Ç—Ä OpenAPI:**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ swagger-ui (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
npm install -g swagger-ui-serve

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ UI –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ–±—â–µ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
swagger-ui-serve docs/openapi.yaml

# –ò–ª–∏ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
swagger-ui-serve docs/service_users_api.yaml
swagger-ui-serve docs/service_orders_api.yaml
```

**Swagger Editor Online:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://editor.swagger.io/
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ª—é–±–æ–π –∏–∑ YAML —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ File ‚Üí Import File
3. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –∏ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ API –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ

### 2. –ò–º–ø–æ—Ä—Ç –≤ Postman

1. –û—Ç–∫—Ä–æ–π—Ç–µ Postman
2. –ù–∞–∂–º–∏—Ç–µ **Import** –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª `docs/postman_collection.json`
4. –ö–æ–ª–ª–µ–∫—Ü–∏—è –±—É–¥–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å –≥–æ—Ç–æ–≤—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã

–í Postman —Å–æ–∑–¥–∞–π—Ç–µ environment —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | Development | Test | Production |
|------------|-------------|------|------------|
| `baseUrl` | `http://localhost:8080` | `http://localhost:18080` | `https://api.systemcontrol.ru` |
| `authToken` | (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) | (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) | (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) |
| `userId` | (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) | (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) | (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) |
| `orderId` | (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) | (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) | (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏) |

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞

```bash
curl -X POST http://localhost:8080/v1/users/login \\
  -H "Content-Type: application/json" \\
  -H "X-Request-ID: req-$(uuidgen)" \\
  -d '{
    "email": "user@example.com",
    "password": "password123"
  }'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": "123e4567-e89b-12d3-a456-426614174000",
      "email": "user@example.com", 
      "name": "–ò–º—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
      "roles": ["user"],
      "created_at": "2023-11-09T10:30:00Z",
      "updated_at": "2023-11-09T10:30:00Z"
    }
  },
  "error": null
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Authorization:

```bash
curl -X GET http://localhost:8080/v1/users/profile \\
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \\
  -H "X-Request-ID: req-$(uuidgen)"
```

## üìñ –û—Å–Ω–æ–≤–Ω—ã–µ endpoints

### üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
|-------|----------|----------|-------------|
| `POST` | `/v1/users/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è | –ù–µ—Ç |
| `POST` | `/v1/users/login` | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | –ù–µ—Ç |
| `GET` | `/v1/users/profile` | –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –î–∞ |
| `PUT` | `/v1/users/profile` | –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å | –î–∞ |
| `GET` | `/v1/users` | –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –î–∞ (admin) |

### üì¶ –ó–∞–∫–∞–∑—ã

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
|-------|----------|----------|-------------|
| `POST` | `/v1/orders` | –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ | –î–∞ |
| `GET` | `/v1/orders` | –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ | –î–∞ |
| `GET` | `/v1/orders/{id}` | –ó–∞–∫–∞–∑ –ø–æ ID | –î–∞ |
| `PUT` | `/v1/orders/{id}/status` | –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å | –î–∞ |
| `POST` | `/v1/orders/{id}/cancel` | –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑ | –î–∞ |

### üìä –°–æ–±—ã—Ç–∏—è –∏ —Å–∏—Å—Ç–µ–º–∞

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
|-------|----------|----------|-------------|
| `GET` | `/v1/events/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π | –î–∞ |
| `GET` | `/health` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è | –ù–µ—Ç |

## üîç –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞

```bash
curl -X POST http://localhost:8080/v1/orders \\
  -H "Content-Type: application/json" \\
  -H "Authorization: Bearer YOUR_TOKEN" \\
  -H "X-Request-ID: req-$(uuidgen)" \\
  -d '{
    "items": [
      {
        "product": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫–æ–Ω",
        "quantity": 3,
        "price": 500.00
      },
      {
        "product": "–ú–æ–Ω—Ç–∞–∂ –¥–≤–µ—Ä–µ–π", 
        "quantity": 2,
        "price": 300.00
      }
    ]
  }'
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

```bash
curl -X GET "http://localhost:8080/v1/orders?status=—Å–æ–∑–¥–∞–Ω&limit=10&offset=0" \\
  -H "Authorization: Bearer YOUR_TOKEN" \\
  -H "X-Request-ID: req-$(uuidgen)"
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞

```bash
curl -X PUT http://localhost:8080/v1/orders/ORDER_ID/status \\
  -H "Content-Type: application/json" \\
  -H "Authorization: Bearer YOUR_TOKEN" \\
  -H "X-Request-ID: req-$(uuidgen)" \\
  -d '{
    "status": "–≤ —Ä–∞–±–æ—Ç–µ"
  }'
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Newman

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Newman (CLI –¥–ª—è Postman)
npm install -g newman

# –ó–∞–ø—É—Å–∫ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
newman run docs/postman_collection.json \\
  --environment your-environment.json \\
  --reporters cli,html \\
  --reporter-html-export test-results.html
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö

```bash
# Development
newman run docs/postman_collection.json \\
  --env-var "baseUrl=http://localhost:8080"

# Test  
newman run docs/postman_collection.json \\
  --env-var "baseUrl=http://localhost:18080"

# Production
newman run docs/postman_collection.json \\
  --env-var "baseUrl=https://api.systemcontrol.ru"
```

## üìä –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

### –£—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (2xx)

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `200` | OK - –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ |
| `201` | Created - –†–µ—Å—É—Ä—Å —Å–æ–∑–¥–∞–Ω |

### –û—à–∏–±–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ (4xx)

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `400` | Bad Request - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö |
| `401` | Unauthorized - –¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è |
| `403` | Forbidden - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ |
| `404` | Not Found - –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω |
| `409` | Conflict - –ö–æ–Ω—Ñ–ª–∏–∫—Ç –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, email —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è) |
| `429` | Too Many Requests - –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ |

### –û—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ (5xx)

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `500` | Internal Server Error - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |
| `503` | Service Unavailable - –°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω |

## üîÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤

### –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç

```json
{
  "success": true,
  "data": {
    // –î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞
  },
  "error": null
}
```

### –û—Ç–≤–µ—Ç —Å –æ—à–∏–±–∫–æ–π

```json
{
  "success": false,
  "data": null,
  "error": {
    "code": "ERROR_CODE",
    "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"
  }
}
```

## üéØ –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Request-ID` –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏:

```bash
curl -H "X-Request-ID: req-1234567890" ...
```

–ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID.

## üìù –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

- **Email**: –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–º email –∞–¥—Ä–µ—Å–æ–º –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º
- **–ü–∞—Ä–æ–ª—å**: –ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤
- **–ò–º—è**: –ú–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞

### –ó–∞–∫–∞–∑—ã

- **Items**: –ú–∏–Ω–∏–º—É–º 1 –ø–æ–∑–∏—Ü–∏—è –≤ –∑–∞–∫–∞–∑–µ
- **Quantity**: –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
- **Price**: –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ —Å 2 –∑–Ω–∞–∫–∞–º–∏ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
- **Status**: –¢–æ–ª—å–∫–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –æ—à–∏–±–æ–∫

1. **–ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø (401)**
   ```json
   {
     "success": false,
     "data": null,
     "error": {
       "code": "UNAUTHORIZED",
       "message": "–¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"
     }
   }
   ```

2. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ (403)**
   ```json
   {
     "success": false,
     "data": null, 
     "error": {
       "code": "FORBIDDEN",
       "message": "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞"
     }
   }
   ```

3. **–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (400)**
   ```json
   {
     "success": false,
     "data": null,
     "error": {
       "code": "VALIDATION_ERROR",
       "message": "–ø–æ–ª–µ 'email' –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è"
     }
   }
   ```

